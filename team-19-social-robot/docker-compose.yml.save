services:
  naoRobotAPI:
    build: 
      context: ./naoRobotAPI
      dockerfile: Dockerfile
    command: python server.py
    image: jperdek/nao-robot-api
    container_name: naoRobotAPI
    env_file: .env
    ports:
      - "5000:5000"
    environment:
      HOST_PORT: ${HOST_PORT:-1234}
      HOST_IP: ${HOST_IP:-127.0.0.1}
      NAO_PORT: ${NAO_PORT:-9559}
      # NAO_IP: host.docker.internal
      NAO_IP: 10.62.44.100
      FLASK_ENV: development
    networks:
      - buildernet
    extra_hosts:
      - "host.docker.internal:host-gateway"

  skeletonFinderAPI:
    build: 
      context: ./skeletonFinderAPI
      dockerfile: Dockerfile
    command: python server.py
    image: jperdek/skeleton-finder-api
    container_name: skeletonFinderAPI
    env_file: .env
    ports:
      - "6001:6001"
    environment:
      FLASK_ENV: development
    volumes:
      - /home/ubuntu/Pictures:/images:ro
    networks:
      - buildernet

  translatorAPI:
    build:
      context: ./translator
      dockerfile: Dockerfile
    command: python nao_pose_service.py
    image: jperdek/translator-api
    container_name: translatorAPI
    env_file: .env
    ports:
      - "7000:7000"
    environment:
      FLASK_ENV: development
    volumes:
      - /home/ubuntu/Pictures:/home/ununtu/Pictures
    depends_on:
      - naoRobotAPI
      - skeletonFinderAPI
    networks:
      - buildernet

networks:
  buildernet:
    driver: "bridge"
